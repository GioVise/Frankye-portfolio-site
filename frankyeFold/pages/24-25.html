<!DOCTYPE html>
<html lang="it">

<head>
    <title>Portfolio</title>
    <link rel="icon" type="image/g" href="../images/G.jpg">
    <meta charset="utf-8">
    <meta name="description" content="Pagina dedicata ai progetti scolastici e personali di Giovanni Visentin">
    <meta name="keywords" content="portfolio, Giovanni Visentin, Frankye LaMerda, progetti, videogiochi, disegni">
    <meta name="author" content="giovann">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--fonts and colors-->
    <link rel="stylesheet" href="../style/style.css">
    <link rel="stylesheet" href="../style/mini.css" media="screen and (max-width: 800px)">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">
</head>

<body id="frankye">
    <header>
    </header>

    <nav id="breadcrumb">
        <a href="frankye_lamerda.html">
            <img src="../images/G.svg" alt="Logo" class="breadcrumbG" />
        </a>
        <div id="br_c">
            Avvento
        </div>
        <div id="br_dx">
            <a href="avvento.html">Avvento</a>
            <a href="gallery.html">Galleria</a>
            <a href="contatti.html">Contatti</a>
        </div>
    </nav>

    <main>
        <section id="content">
            <h1 lang="it">Avvento</h1>
            <div class="presentazione pr_avvento">
                <p>Dove è nato tutto.<br>Questo fu il calendario dell'avvento dell'anno corso 24-25, con molte cose dubbie,
                molte cose sensibili e insensibili.</p>
            </div>

        </section>

        <section id="avvento-tree">

            <div class="tree-row top">
                <figure class="advent-item closed star" data-day="25" tabindex="0" role="button" aria-label="Apri la casella del giorno 25">
                    <div class="door"><span>25</span></div>
                    <img src="../images/24-25/25.png" alt="Giorno 25 - Stella">
                </figure>
            </div>

            <div class="tree-row">
                <figure class="advent-item closed" data-day="2" tabindex="0" role="button" aria-label="Apri la casella del giorno 2">
                    <div class="door"><span>2</span></div>
                    <img src="../images/24-25/2.png" alt="Giorno 2">
                </figure>
                <figure class="advent-item closed" data-day="6" tabindex="0" role="button" aria-label="Apri la casella del giorno 6">
                    <div class="door"><span>6</span></div>
                    <img src="../images/24-25/6.png" alt="Giorno 6">
                </figure>
            </div>

            <div class="tree-row">
                <figure class="advent-item closed" data-day="11" tabindex="0" role="button" aria-label="Apri la casella del giorno 11">
                    <div class="door"><span>11</span></div>
                    <img src="../images/24-25/11.png" alt="Giorno 11">
                </figure>
                <figure class="advent-item closed" data-day="21" tabindex="0" role="button" aria-label="Apri la casella del giorno 21">
                    <div class="door"><span>21</span></div>
                    <img src="../images/24-25/21.png" alt="Giorno 21">
                </figure>
                <figure class="advent-item closed" data-day="15" tabindex="0" role="button" aria-label="Apri la casella del giorno 15">
                    <div class="door"><span>15</span></div>
                    <img src="../images/24-25/15.png" alt="Giorno 15">
                </figure>
            </div>

            <div class="tree-row">
                
                <figure class="advent-item closed" data-day="7" tabindex="0" role="button" aria-label="Apri la casella del giorno 7">
                    <div class="door"><span>7</span></div>
                    <img src="../images/24-25/7.png" alt="Giorno 7">
                </figure>
                <figure class="advent-item closed" data-day="23" tabindex="0" role="button" aria-label="Apri la casella del giorno 23">
                    <div class="door"><span>23</span></div>
                    <img src="../images/24-25/23.png" alt="Giorno 23">
                </figure>
                <figure class="advent-item closed" data-day="13" tabindex="0" role="button" aria-label="Apri la casella del giorno 13">
                    <div class="door"><span>13</span></div>
                    <img src="../images/24-25/13.png" alt="Giorno 13">
                </figure>
                <figure class="advent-item closed" data-day="5" tabindex="0" role="button" aria-label="Apri la casella del giorno 5">
                    <div class="door"><span>5</span></div>
                    <img src="../images/24-25/5.png" alt="Giorno 5">
                </figure>
            </div>

            <div class="tree-row">
                <figure class="advent-item closed" data-day="17" tabindex="0" role="button" aria-label="Apri la casella del giorno 17">
                    <div class="door"><span>17</span></div>
                    <img src="../images/24-25/17.png" alt="Giorno 17">
                </figure>
                <figure class="advent-item closed" data-day="1" tabindex="0" role="button" aria-label="Apri la casella del giorno 1">
                    <div class="door"><span>1</span></div>
                    <img src="../images/24-25/1.png" alt="Giorno 1">
                </figure>
                <figure class="advent-item closed" data-day="3" tabindex="0" role="button" aria-label="Apri la casella del giorno 3">
                    <div class="door"><span>3</span></div>
                    <img src="../images/24-25/3.png" alt="Giorno 3">
                </figure>
                <figure class="advent-item closed" data-day="18" tabindex="0" role="button" aria-label="Apri la casella del giorno 18">
                    <div class="door"><span>18</span></div>
                    <img src="../images/24-25/18.png" alt="Giorno 18">
                </figure>
                <figure class="advent-item closed" data-day="14" tabindex="0" role="button" aria-label="Apri la casella del giorno 14">
                    <div class="door"><span>14</span></div>
                    <img src="../images/24-25/14.png" alt="Giorno 14">
                </figure>
            </div>

            <div class="tree-row">
                <figure class="advent-item closed" data-day="10" tabindex="0" role="button" aria-label="Apri la casella del giorno 10">
                    <div class="door"><span>10</span></div>
                    <img src="../images/24-25/10.png" alt="Giorno 10">
                </figure>
                <figure class="advent-item closed" data-day="9" tabindex="0" role="button" aria-label="Apri la casella del giorno 9">
                    <div class="door"><span>9</span></div>
                    <img src="../images/24-25/9.png" alt="Giorno 9">
                </figure>
                <figure class="advent-item closed" data-day="20" tabindex="0" role="button" aria-label="Apri la casella del giorno 20">
                    <div class="door"><span>20</span></div>
                    <img src="../images/24-25/20.png" alt="Giorno 20">
                </figure>
                <figure class="advent-item closed" data-day="16" tabindex="0" role="button" aria-label="Apri la casella del giorno 16">
                    <div class="door"><span>16</span></div>
                    <img src="../images/24-25/16.png" alt="Giorno 16">
                </figure>
                <figure class="advent-item closed" data-day="8" tabindex="0" role="button" aria-label="Apri la casella del giorno 8">
                    <div class="door"><span>8</span></div>
                    <img src="../images/24-25/8.png" alt="Giorno 8">
                </figure>
                <figure class="advent-item closed" data-day="24" tabindex="0" role="button" aria-label="Apri la casella del giorno 24">
                    <div class="door"><span>24</span></div>
                    <img src="../images/24-25/24.png" alt="Giorno 24">
                </figure>
            </div>

            <div class="tree-row">
                <figure class="advent-item closed" data-day="22" tabindex="0" role="button" aria-label="Apri la casella del giorno 22">
                    <div class="door"><span>22</span></div>
                    <img src="../images/24-25/22.png" alt="Giorno 22">
                </figure>
                <figure class="advent-item closed" data-day="19" tabindex="0" role="button" aria-label="Apri la casella del giorno 19">
                    <div class="door"><span>19</span></div>
                    <img src="../images/24-25/19.png" alt="Giorno 19">
                </figure>
                <figure class="advent-item closed" data-day="4" tabindex="0" role="button" aria-label="Apri la casella del giorno 4">
                    <div class="door"><span>4</span></div>
                    <img src="../images/24-25/4.png" alt="Giorno 4">
                </figure>
                <figure class="advent-item closed" data-day="12" tabindex="0" role="button" aria-label="Apri la casella del giorno 12">
                    <div class="door"><span>12</span></div>
                    <img src="../images/24-25/12.png" alt="Giorno 12">
                </figure>
            </div>

            <div class="tree-row trunk-row" data-day="26" tabindex="0" role="button" aria-label="Giorno 26">
                <figure class="advent-item trunk">
                    <img src="../images/24-25/26.png" alt="Tronco">
                </figure>
            </div>

            <div class="tree-row ground-row">
                <figure class="advent-item ground closed"data-day="27" tabindex="0" role="button" aria-label="Apri la casella del giorno 27">
                    <div class="door"><span>27</span></div>
                    <img src="../images/24-25/27.png" alt="Terra">
                </figure>
            </div>

        </section>

        <div class="reset-container">
            <button id="reset-btn">Richiudi tutto</button>
        </div>


    </main>
    
    <footer>
        <section id="totop">
            <a href="#content" id="backtotop">back to top</a>
        </section>
        <p>Portfolio di Giovanni Visentin - &copy; 2025</p>
    </footer>

    <div id="advent-lightbox" class="lightbox-overlay">
        <img id="lightbox-img" src="" alt="Zoom">
    </div>

    

   <script>
        // 1. SELEZIONE ELEMENTI
        const treeItems = document.querySelectorAll('.advent-item');
        const lightbox = document.getElementById('advent-lightbox');
        const lightboxImg = document.getElementById('lightbox-img');
        const lightboxCaption = document.getElementById('lightbox-caption');
        const closeBtn = document.querySelector('.close-btn');

        // 2. FUNZIONE: CARICA LA MEMORIA ALL'AVVIO
        function loadOpenedDoors() {
            const savedDoors = JSON.parse(localStorage.getItem('calendarioAperto')) || [];

            savedDoors.forEach(day => {
                // Cerca la casella con quel data-day
                const itemToOpen = document.querySelector(`.advent-item[data-day="${day}"]`);
                if (itemToOpen) {
                    itemToOpen.classList.remove('closed');
                }
            });
        }

        // Esegui subito all'avvio
        loadOpenedDoors();


        // 3. FUNZIONE: LOGICA DEL CLICK (Unita e Pulita)
        function handleAdventClick(element) {
            
            // A. SE LA CASELLA È CHIUSA -> APRILA E SALVA
            if (element.classList.contains('closed')) {
                // 1. Apri visivamente
                element.classList.remove('closed');
                
                // 2. Salva in memoria
                const dayNumber = element.getAttribute('data-day');
                const savedDoors = JSON.parse(localStorage.getItem('calendarioAperto')) || [];
                
                if (!savedDoors.includes(dayNumber)) {
                    savedDoors.push(dayNumber);
                    localStorage.setItem('calendarioAperto', JSON.stringify(savedDoors));
                }
                
                // STOP! Non aprire la lightbox ora.
                return; 
            }

            // B. SE È GIÀ APERTA -> APRI LIGHTBOX
            const img = element.querySelector('img');
            if (img) {
                lightboxImg.src = img.src;
                
                // Se hai aggiunto il <p id="lightbox-caption"> nella lightbox, usiamo l'alt
                if(lightboxCaption) {
                    lightboxCaption.textContent = img.alt;
                }
                
                lightbox.classList.add('active');
                document.body.classList.add('no-scroll');
            }
        }


        // 4. ASSEGNAZIONE EVENTI (Mouse e Tastiera)
        treeItems.forEach(item => {
            
            // Click col mouse
            item.addEventListener('click', function(e) {
                e.preventDefault(); // Evita comportamenti strani
                handleAdventClick(this);
            });

            // Accessibilità Tastiera (Invio o Spazio)
            item.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault(); // Evita lo scroll con spazio
                    handleAdventClick(this);
                }
            });
        });


        // 5. CHIUSURA LIGHTBOX
        function closeLightbox() {
            lightbox.classList.remove('active');
            document.body.classList.remove('no-scroll');
        }

        // Chiudi con la X (se esiste il bottone)
        if(closeBtn) closeBtn.addEventListener('click', closeLightbox);

        // Chiudi cliccando fuori
        lightbox.addEventListener('click', function(e) {
            if (e.target === lightbox) {
                closeLightbox();
            }
        });
        // --- LOGICA PULSANTE RESET ---
        const resetBtn = document.getElementById('reset-btn');

        if (resetBtn) {
            resetBtn.addEventListener('click', function() {
                
                // 1. Chiedi conferma per evitare click per sbaglio
                if (confirm("Vuoi tu davvero richiudere tutte le caselle? Questa azione non può essere annullata, tristemente.")) {
                    
                    // 2. Cancella la memoria del browser
                    localStorage.removeItem('calendarioAperto');
                    
                    // 3. Richiudi visivamente tutte le porte
                    const allItems = document.querySelectorAll('.advent-item');
                    allItems.forEach(item => {
                        item.classList.add('closed');
                    });
                }
            });
        }   

    </script>

</body>
</html>